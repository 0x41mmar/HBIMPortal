{"version":3,"sources":["webpack:///./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/Vector.js?599a","webpack:///./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/BaseObject.js?9d64","webpack:///./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/index.js?c883","webpack:///./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/EventsEmitter.js?6259","webpack:///./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/Field.js?d0e6","webpack:///./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/MagneticField.js?866a","webpack:///./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/Particle.js?fffe","webpack:///./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/ParticleEmitter.js?d6ae","webpack:///./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/ParticleSystem.js?7590"],"names":["Vector","x","y","z","_x","_y","_z","Math","sqrt","m","magnitude","scaleFactor","vector","center","radius","magnitudeSqr","size","data","BaseObject","id","type","_offset","_position","_selectable","_transformable","_type","_id","transformable","selectable","Instance","EventsEmitter","_events","event","fct","push","undefined","splice","indexOf","tmpArray","slice","i","length","result","apply","Array","prototype","call","arguments","format","d","Date","getTime","guid","replace","c","r","random","floor","toString","Field","particle","MagneticField","_force","particlePos","fieldPos","dX","dY","dZ","force","_charge","pow","abs","particleAcc","_acceleration","Particle","dof","_velocity","_recycled","_radius","_dof","_lifeTime","ptr","fields","forEach","field","applyForce","dt","lifeTime","ParticleEmitter","_spread","PI","_emissionRate","angle1","angle2","cos","sin","emissionRate","velocity","spread","charge","ParticleSystem","maxParticles","_maxParticles","_emittedParticles","_particleIdx","_recycleBin","_particles","_emitters","_fields","emitter","getId","addNewParticles","filterParticles","emitNumber","popRecycle","emitParticle","pop","reset","pushRecycle","filterParticle","submitToFields","step"],"mappings":"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","file":"49.js","sourcesContent":["\r\nexport default class Vector {\r\n\r\n  constructor (x = 0, y = 0, z = 0) {\r\n    this._x = x\r\n    this._y = y\r\n    this._z = z\r\n  }\r\n\r\n  getX () { return this._x }\r\n  getY () { return this._y }\r\n  getZ () { return this._z }\r\n\r\n  magnitude () {\r\n\r\n    return Math.sqrt(\r\n      this._x * this._x +\r\n      this._y * this._y +\r\n      this._z * this._z)\r\n  }\r\n\r\n  asUnitVector () {\r\n\r\n    var m = this.magnitude()\r\n\r\n    return new Vector(\r\n      this._x / m,\r\n      this._y / m,\r\n      this._z / m)\r\n  }\r\n\r\n  scaled (scaleFactor) {\r\n\r\n    var m = this.magnitude()\r\n\r\n    return new Vector(\r\n      this._x * scaleFactor / m,\r\n      this._y * scaleFactor / m,\r\n      this._z * scaleFactor / m)\r\n  }\r\n\r\n  multiply (scaleFactor) {\r\n\r\n    this._x *= scaleFactor\r\n    this._y *= scaleFactor\r\n    this._z *= scaleFactor\r\n\r\n    return this\r\n  }\r\n\r\n  add (vector) {\r\n\r\n    this._x += vector._x\r\n    this._y += vector._y\r\n    this._z += vector._z\r\n\r\n    return this\r\n  }\r\n\r\n  vectorTo (vector) {\r\n\r\n    return new Vector(\r\n      vector._x - this._x,\r\n      vector._y - this._y,\r\n      vector._z - this._z\r\n    )\r\n  }\r\n\r\n  withinSphere (center, radius) {\r\n\r\n    var magnitudeSqr =\r\n      (this._x - center._x) * (this._x - center._x) +\r\n      (this._y - center._y) * (this._y - center._y) +\r\n      (this._z - center._z) * (this._z - center._z)\r\n\r\n    return magnitudeSqr < radius * radius\r\n  }\r\n\r\n  withinBox (center, size) {\r\n\r\n    //TODO\r\n\r\n    return true\r\n  }\r\n\r\n  copy () {\r\n\r\n    return new Vector(this._x, this._y, this._z)\r\n  }\r\n\r\n  static fromArray (data) {\r\n\r\n    return new Vector(data[0], data[1], data[2])\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/Vector.js","import Vector from './Vector'\r\n\r\nexport default class BaseObject {\r\n\r\n  constructor (id, type) {\r\n    \r\n    this._offset        = new Vector()\r\n    this._position      = new Vector()\r\n    this._selectable    = true\r\n    this._transformable = true\r\n    this._type          = type\r\n    this._id            = id\r\n  }\r\n\r\n  setPosition (x, y, z) {\r\n\r\n    this._position = new Vector(\r\n      x + this._offset._x,\r\n      y + this._offset._y,\r\n      z + this._offset._z)\r\n  }\r\n\r\n  getPosition () {\r\n\r\n    return this._position\r\n  }\r\n\r\n  setOffset (x, y, z) {\r\n\r\n    this._offset = new Vector(x, y, z)\r\n  }\r\n\r\n  getOffset () {\r\n\r\n    return this._offset\r\n  }\r\n\r\n  setTransformable (transformable) {\r\n\r\n    this._transformable = transformable\r\n  }\r\n\r\n  getTransformable () {\r\n\r\n    return this._transformable\r\n  }\r\n\r\n  setSelectable (selectable) {\r\n\r\n    this._selectable = selectable\r\n  }\r\n\r\n  getSelectable () {\r\n\r\n    return this._selectable\r\n  }\r\n\r\n  getType() {\r\n\r\n    return this._type\r\n  }\r\n\r\n  getId() {\r\n\r\n    return this._id\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/BaseObject.js","import ParticleSystem from './ParticleSystem'\r\nimport Vector from './Vector'\r\n\r\nexport default {\r\n  Instance: ParticleSystem,\r\n  Vector\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/index.js","\r\nexport default class EventsEmitter {\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  //\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  constructor() {\r\n\r\n    this._events = {};\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  //\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  on(event, fct) {\r\n\r\n    this._events[event] = this._events[event]\t|| [];\r\n    this._events[event].push(fct);\r\n\r\n    return this;\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  //\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  off(event, fct) {\r\n\r\n    if(event == undefined){\r\n      this._events = {};\r\n      return;\r\n    }\r\n\r\n    if(event in this._events === false)\r\n      return;\r\n\r\n    if(fct){\r\n      this._events[event].splice(\r\n        this._events[event].indexOf(fct), 1);\r\n    }\r\n    else {\r\n      this._events[event] = [];\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  //\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  emit(event /* , args... */) {\r\n\r\n    if(this._events[event] === undefined)\r\n      return;\r\n\r\n    var tmpArray = this._events[event].slice();\r\n\r\n    for(var i = 0; i < tmpArray.length; ++i) {\r\n\r\n      var result\t= tmpArray[i].apply(this,\r\n        Array.prototype.slice.call(arguments, 1));\r\n\r\n      if(result !== undefined )\r\n        return result;\r\n    }\r\n\r\n    return undefined;\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  //\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  guid(format='xxxxxxxxxxxx') {\r\n\r\n    var d = new Date().getTime();\r\n\r\n    var guid = format.replace(\r\n      /[xy]/g,\r\n      function (c) {\r\n        var r = (d + Math.random() * 16) % 16 | 0;\r\n        d = Math.floor(d / 16);\r\n        return (c == 'x' ? r : (r & 0x7 | 0x8)).toString(16);\r\n      });\r\n\r\n    return guid;\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/EventsEmitter.js","import BaseObject from './BaseObject'\r\nimport Vector from './Vector'\r\n\r\nexport default class Field extends BaseObject {\r\n\r\n  constructor (id, type) {\r\n\r\n    super(id, type)\r\n  }\r\n\r\n  computeAcceleration (particle) {\r\n\r\n    return new Vector()\r\n  }\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/Field.js","\r\nimport Field from './Field'\r\n\r\nexport default class MagneticField extends Field {\r\n\r\n  constructor (id) {\r\n\r\n    super(id, 1)\r\n\r\n    this._force = 0\r\n  }\r\n\r\n  applyForce (particle) {\r\n\r\n    let particlePos = particle._position\r\n\r\n    let fieldPos = this._position\r\n\r\n    let dX = fieldPos._x - particlePos._x\r\n    let dY = fieldPos._y - particlePos._y\r\n    let dZ = fieldPos._z - particlePos._z\r\n\r\n    let force = particle._charge * this._force / Math.pow((\r\n      dX * dX +\r\n      dY * dY +\r\n      dZ * dZ), 1.5)\r\n\r\n    if (Math.abs(force) > 0.001) {\r\n\r\n      let particleAcc = particle._acceleration\r\n\r\n      particleAcc._x += dX * force\r\n      particleAcc._y += dY * force\r\n      particleAcc._z += dZ * force\r\n    }\r\n  }\r\n\r\n  setForce (force) {\r\n\r\n    this._force = force\r\n  }\r\n\r\n  getForce () {\r\n\r\n    return this._force\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/MagneticField.js","import Vector from './Vector'\r\n\r\nexport default class Particle {\r\n\r\n  constructor (dof) {\r\n\r\n    this._velocity     = new Vector()\r\n    this._position     = new Vector()\r\n    this._acceleration = new Vector()\r\n    this._recycled     = false\r\n    this._radius       = 0.03\r\n    this._dof          = dof\r\n    this._lifeTime     = 30\r\n    this._charge       = 1\r\n    this.ptr           = 1  //compat with wasm\r\n  }\r\n\r\n  reset () {\r\n    this._recycled = false\r\n    this._lifeTime = 30\r\n  }\r\n\r\n  submitToFields (fields) {\r\n\r\n    this._acceleration._x = 0\r\n    this._acceleration._y = 0\r\n    this._acceleration._z = 0\r\n\r\n    fields.forEach((field) => {\r\n\r\n      field.applyForce(this)\r\n    })\r\n  }\r\n\r\n  step (dt) {\r\n\r\n    this._lifeTime -= dt\r\n\r\n    this._velocity._x += this._acceleration._x * dt\r\n    this._velocity._y += this._acceleration._y * dt\r\n    this._velocity._z += this._acceleration._z * dt\r\n\r\n    this._position._x += this._velocity._x * this._dof._x * dt\r\n    this._position._y += this._velocity._y * this._dof._y * dt\r\n    this._position._z += this._velocity._z * this._dof._z * dt\r\n  }\r\n\r\n  getRecycled () {\r\n\r\n    return this._recycled\r\n  }\r\n\r\n  getLifeTime () {\r\n\r\n    return this._lifeTime\r\n  }\r\n\r\n  setLifeTime (lifeTime) {\r\n\r\n    this._lifeTime = lifeTime\r\n  }\r\n\r\n  getAcceleration () {\r\n\r\n    return this._acceleration\r\n  }\r\n\r\n  getPosition () {\r\n\r\n    return this._position\r\n  }\r\n\r\n  getCharge () {\r\n\r\n    return this._charge\r\n  }\r\n\r\n  getRadius () {\r\n\r\n    return this._radius\r\n  }\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/Particle.js","import BaseObject from './BaseObject'\r\nimport Vector from './Vector'\r\n\r\nexport default class ParticleEmitter extends BaseObject {\r\n\r\n  constructor (id) {\r\n\r\n    super(id, 0)\r\n\r\n    this._spread       = 2 * Math.PI / 180\r\n    this._emissionRate = 500\r\n    this._velocity     = 10\r\n    this._charge       = 1\r\n  }\r\n\r\n  emitNumber (dt) {\r\n\r\n    return Math.floor(this._emissionRate * dt)\r\n  }\r\n\r\n  emitParticle (particle) {\r\n\r\n    var angle1 = this._spread * (2 * Math.random() - 1)\r\n    var angle2 = this._spread * (2 * Math.random() - 1)\r\n\r\n    particle._velocity._x = this._velocity *\r\n      Math.cos(angle1) * Math.cos(angle2)\r\n\r\n    particle._velocity._y = this._velocity *\r\n      Math.sin(angle1) * Math.cos(angle2)\r\n\r\n    particle._velocity._z = this._velocity *\r\n      Math.sin(angle2)\r\n\r\n    particle._position._x = this._position._x\r\n    particle._position._y = this._position._y\r\n    particle._position._z = this._position._z\r\n\r\n    particle._charge = this._charge\r\n  }\r\n\r\n  setEmissionRate (emissionRate) {\r\n\r\n    this._emissionRate = emissionRate\r\n  }\r\n\r\n  getEmissionRate () {\r\n\r\n    return this._emissionRate\r\n  }\r\n\r\n  setVelocity (velocity) {\r\n\r\n    this._velocity = velocity\r\n  }\r\n\r\n  getVelocity () {\r\n\r\n    return this._velocity\r\n  }\r\n\r\n  setSpread (spread) {\r\n\r\n    this._spread = spread\r\n  }\r\n\r\n  getSpread () {\r\n\r\n    return this._spread\r\n  }\r\n\r\n  setCharge (charge) {\r\n\r\n    this._charge = charge\r\n  }\r\n\r\n  getCharge () {\r\n\r\n    return this._charge\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/ParticleEmitter.js","import ParticleEmitter from './ParticleEmitter'\r\nimport MagneticField from './MagneticField'\r\nimport EventsEmitter from './EventsEmitter'\r\nimport Particle from './Particle'\r\nimport Vector from './Vector'\r\n\r\nexport default class ParticleSystem extends EventsEmitter {\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  //\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  constructor (maxParticles) {\r\n\r\n    super()\r\n\r\n    this._maxParticles = maxParticles\r\n    this._dof = new Vector(1, 1, 1)\r\n    this._emittedParticles = 0\r\n    this._particleIdx = 0\r\n    this._recycleBin = []\r\n    this._particles = []\r\n    this._emitters = []\r\n    this._fields = []\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  //\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  setMaxParticles (maxParticles) {\r\n\r\n    this._maxParticles = maxParticles\r\n  }\r\n\r\n  getMaxParticles () {\r\n\r\n    return this._maxParticles\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  // Returns object by id\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  getObjectById (id) {\r\n\r\n    for (var emitter of this._emitters) {\r\n      if (emitter.getId() === id) {\r\n        return emitter\r\n      }\r\n    }\r\n\r\n    for (var field of this._fields) {\r\n      if (field.getId() === id) {\r\n        return field\r\n      }\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  // Returns emitter by id\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  getEmitter (id) {\r\n\r\n    for (var emitter of this._emitters) {\r\n      if (emitter.getId() === id) {\r\n        return emitter\r\n      }\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  // Returns magnetic field by id\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  getMagneticField (id) {\r\n\r\n    for (var field of this._fields) {\r\n      if (field.getId() === id) {\r\n        return field\r\n      }\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  //\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  setDof (x, y, z) {\r\n\r\n    this._dof = new Vector(x, y, z)\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  // clean up all objects\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  destroy () {\r\n\r\n    this._recycleBin = []\r\n\r\n    this._particles = []\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  // Adds emitter object\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  addEmitter (id) {\r\n\r\n    var emitter = new ParticleEmitter(id)\r\n\r\n    this._emitters.push(emitter)\r\n\r\n    return emitter\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  // Adds magnetic field object\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  addMagneticField (id) {\r\n\r\n    var field = new MagneticField(id)\r\n\r\n    this._fields.push(field)\r\n\r\n    return field\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  // updates simulation\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  step (dt) {\r\n\r\n    this.addNewParticles(dt)\r\n    this.filterParticles(dt)\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  // add new particles step\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  addNewParticles (dt) {\r\n\r\n    this._emitters.forEach((emitter) => {\r\n\r\n      for (var i = 0; i < emitter.emitNumber(dt); ++i) {\r\n\r\n        var particle = this.popRecycle()\r\n\r\n        if (particle) {\r\n\r\n          emitter.emitParticle(particle)\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  // push a particle to recycle bin\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  pushRecycle (particle) {\r\n\r\n    --this._emittedParticles\r\n\r\n    particle._recycled = true\r\n\r\n    this._recycleBin.push(particle)\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  // pop a particle from recycle bin\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  popRecycle () {\r\n\r\n    if (this._emittedParticles > this._maxParticles - 1) {\r\n      return null\r\n    }\r\n\r\n    ++this._emittedParticles\r\n\r\n    var particle = this._recycleBin.pop()\r\n\r\n    if (particle) {\r\n\r\n      particle.reset()\r\n\r\n      return particle\r\n    }\r\n\r\n    particle = new Particle(this._dof)\r\n\r\n    this._particles.push(particle)\r\n\r\n    return particle\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  // filter particles using lifeTime\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  filterParticle (particle) {\r\n\r\n    if (particle._recycled) {\r\n\r\n      return true\r\n    }\r\n\r\n    if (particle._lifeTime < 0) {\r\n\r\n      this.pushRecycle(particle)\r\n\r\n      return true\r\n    }\r\n\r\n    return false\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  // filter particles step\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  filterParticles (dt) {\r\n\r\n    this._particles.forEach((particle) => {\r\n\r\n      if (!this.filterParticle(particle)) {\r\n\r\n        particle.submitToFields(this._fields)\r\n\r\n        particle.step(dt)\r\n      }\r\n    })\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  // initialize particle index\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  initParticleLoop () {\r\n\r\n    this._particleIdx = 0\r\n  }\r\n\r\n  ///////////////////////////////////////////////////////////////////\r\n  // initialize particule index\r\n  //\r\n  ///////////////////////////////////////////////////////////////////\r\n  nextParticle () {\r\n\r\n    if(this._particleIdx < this._particles.length) {\r\n\r\n      return this._particles[this._particleIdx++]\r\n    }\r\n\r\n    return { ptr:0 } //compatibility with asm.js/wasm\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/viewer.components/Viewer.Extensions.Dynamic/Viewing.Extension.Particle/ParticleSystem/ParticleSystem.js"],"sourceRoot":""}